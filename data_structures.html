

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Data Structure &mdash; mbuild 0.7.1 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="mbuild 0.7.1 documentation" href="index.html"/>
        <link rel="next" title="Coordinate transformations" href="coordinate_transforms.html"/>
        <link rel="prev" title="Building a Simple Alkane" href="tutorials/tutorial_polymers.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> mbuild
          

          
          </a>

          
            
            
              <div class="version">
                0.7.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="tutorials/tutorials.html">Tutorials</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Data Structure</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#compound">Compound</a></li>
<li class="toctree-l2"><a class="reference internal" href="#port">Port</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="coordinate_transforms.html">Coordinate transformations</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="recipes.html">Recipes</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">mbuild</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Data Structure</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/data_structures.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="data-structure">
<h1>Data Structure<a class="headerlink" href="#data-structure" title="Permalink to this headline">¶</a></h1>
<p>The primary building blocks in an mBuild hierarchy inherit from the
<code class="docutils literal"><span class="pre">Compound</span></code> class.  <code class="docutils literal"><span class="pre">Compounds</span></code> maintain an ordered set of <code class="docutils literal"><span class="pre">children</span></code>
which are other <code class="docutils literal"><span class="pre">Compounds</span></code>.  In addition, an independent, ordered dictionary
of <code class="docutils literal"><span class="pre">labels</span></code> is maintained through which users can reference any other
<code class="docutils literal"><span class="pre">Compound</span></code> in the hierarchy via descriptive strings.  Every <code class="docutils literal"><span class="pre">Compound</span></code>
knows its parent <code class="docutils literal"><span class="pre">Compound</span></code>, one step up in the hierarchy, and knows which
<code class="docutils literal"><span class="pre">Compounds</span></code> reference it in their <code class="docutils literal"><span class="pre">labels</span></code>.  <code class="docutils literal"><span class="pre">Ports</span></code> are a special type
of <code class="docutils literal"><span class="pre">Compound</span></code> which are used internally to connect different <code class="docutils literal"><span class="pre">Compounds</span></code>
using the equivalence transformations described below.</p>
<p><code class="docutils literal"><span class="pre">Compounds</span></code> at the bottom of an mBuild hierarchy, the leafs of the tree, are
referred to as <code class="docutils literal"><span class="pre">Particles</span></code> and can be instantiated as <code class="docutils literal"><span class="pre">foo</span> <span class="pre">=</span>
<span class="pre">mb.Particle(name='bar')</span></code>. Note however, that this merely serves to illustrate
that this <code class="docutils literal"><span class="pre">Compound</span></code> is at the bottom of the hierarchy; <code class="docutils literal"><span class="pre">Particle</span></code> is simply
an alias for <code class="docutils literal"><span class="pre">Compound</span></code> which can be used to clarify the intended role of an
object you are creating. The method <code class="docutils literal"><span class="pre">Compound.particles()</span></code> traverses the
hierarchy to the bottom and yields those <code class="docutils literal"><span class="pre">Compounds</span></code>. <code class="docutils literal"><span class="pre">Compound.root()</span></code>
returns the compound at the top of the hierarchy.</p>
<div class="section" id="compound">
<h2>Compound<a class="headerlink" href="#compound" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="mbuild.compound.Compound">
<em class="property">class </em><code class="descclassname">mbuild.compound.</code><code class="descname">Compound</code><span class="sig-paren">(</span><em>subcompounds=None</em>, <em>name=None</em>, <em>pos=None</em>, <em>charge=0.0</em>, <em>periodicity=None</em>, <em>port_particle=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mbuild/compound.html#Compound"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mbuild.compound.Compound" title="Permalink to this definition">¶</a></dt>
<dd><p>A building block in the mBuild hierarchy.</p>
<p>Compound is the superclass of all composite building blocks in the mBuild
hierarchy. That is, all composite building blocks must inherit from
compound, either directly or indirectly. The design of Compound follows the
Composite design pattern (Gamma, Erich; Richard Helm; Ralph Johnson; John
M. Vlissides (1995). Design Patterns: Elements of Reusable Object-Oriented
Software. Addison-Wesley. p. 395. ISBN 0-201-63361-2.), with Compound being
the composite, and Particle playing the role of the primitive (leaf) part,
where Particle is in fact simply an alias to the Compound class.</p>
<p>Compound maintains a list of children (other Compounds contained within),
and provides a means to tag the children with labels, so that the compounds
can be easily looked up later. Labels may also point to objects outside the
Compound&#8217;s containment hierarchy. Compound has built-in support for copying
and deepcopying Compound hierarchies, enumerating particles or bonds in the
hierarchy, proximity based searches, visualization, I/O operations, and a
number of other convenience methods.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>subcompounds</strong> : mb.Compound or list of mb.Compound, optional, default=None</p>
<blockquote>
<div><p>One or more compounds to be added to self.</p>
</div></blockquote>
<p><strong>name</strong> : str, optional, default=self.__class__.__name__</p>
<blockquote>
<div><p>The type of Compound.</p>
</div></blockquote>
<p><strong>pos</strong> : np.ndarray, shape=(3,), dtype=float, optional, default=[0, 0, 0]</p>
<blockquote>
<div><p>The position of the Compound in Cartestian space</p>
</div></blockquote>
<p><strong>charge</strong> : float, optional, default=0.0</p>
<blockquote>
<div><p>Currently not used. Likely removed in next release.</p>
</div></blockquote>
<p><strong>periodicity</strong> : np.ndarray, shape=(3,), dtype=float, optional, default=[0, 0, 0]</p>
<blockquote>
<div><p>The periodic lengths of the Compound in the x, y and z directions.
Defaults to zeros which is treated as non-periodic.</p>
</div></blockquote>
<p><strong>port_particle</strong> : bool, optional, default=False</p>
<blockquote class="last">
<div><p>Whether or not this Compound is part of a Port</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Attributes</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">boundingbox</span></code></td>
<td></td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">center</span></code></td>
<td></td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">contains_rigid</span></code></td>
<td></td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">max_rigid_id</span></code></td>
<td></td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">n_particles</span></code></td>
<td></td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">n_bonds</span></code></td>
<td></td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">root</span></code></td>
<td></td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">xyz</span></code></td>
<td></td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">xyz_with_ports</span></code></td>
<td></td>
</tr>
</tbody>
</table>
<table border="1" class="docutils">
<colgroup>
<col width="4%" />
<col width="96%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>bond_graph</td>
<td>(mb.BondGraph) Graph-like object that stores bond information for this Compound</td>
</tr>
<tr class="row-even"><td>children</td>
<td>(OrderedSet) Contains all children (other Compounds).</td>
</tr>
<tr class="row-odd"><td>labels</td>
<td>(OrderedDict) Labels to Compound/Atom mappings. These do not necessarily need not be in self.children.</td>
</tr>
<tr class="row-even"><td>parent</td>
<td>(mb.Compound) The parent Compound that contains this part. Can be None if this compound is the root of the containment hierarchy.</td>
</tr>
<tr class="row-odd"><td>referrers</td>
<td>(set) Other compounds that reference this part with labels.</td>
</tr>
<tr class="row-even"><td>rigid_id</td>
<td>(int, default=None) The ID of the rigid body that this Compound belongs to.  Only Particles (the bottom of the containment hierarchy) can have integer values for <cite>rigid_id</cite>. Compounds containing rigid particles will always have <cite>rigid_id == None</cite>. See also <cite>contains_rigid</cite>.</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="mbuild.compound.Compound.add">
<code class="descname">add</code><span class="sig-paren">(</span><em>new_child</em>, <em>label=None</em>, <em>containment=True</em>, <em>replace=False</em>, <em>inherit_periodicity=True</em>, <em>reset_rigid_ids=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mbuild/compound.html#Compound.add"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mbuild.compound.Compound.add" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a part to the Compound.</p>
<dl class="docutils">
<dt>Note:</dt>
<dd>This does not necessarily add the part to self.children but may
instead be used to add a reference to the part to self.labels. See
&#8216;containment&#8217; argument.</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>new_child</strong> : mb.Compound or list-like of mb.Compound</p>
<blockquote>
<div><p>The object(s) to be added to this Compound.</p>
</div></blockquote>
<p><strong>label</strong> : str, optional</p>
<blockquote>
<div><p>A descriptive string for the part.</p>
</div></blockquote>
<p><strong>containment</strong> : bool, optional, default=True</p>
<blockquote>
<div><p>Add the part to self.children.</p>
</div></blockquote>
<p><strong>replace</strong> : bool, optional, default=True</p>
<blockquote>
<div><p>Replace the label if it already exists.</p>
</div></blockquote>
<p><strong>inherit_periodicity</strong> : bool, optional, default=True</p>
<blockquote>
<div><p>Replace the periodicity of self with the periodicity of the
Compound being added</p>
</div></blockquote>
<p><strong>reset_rigid_ids</strong> : bool, optional, default=True</p>
<blockquote class="last">
<div><p>If the Compound to be added contains rigid bodies, reset the
rigid_ids such that values remain distinct from rigid_ids
already present in <cite>self</cite>. Can be set to False if attempting
to add Compounds to an existing rigid body.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="mbuild.compound.Compound.add_bond">
<code class="descname">add_bond</code><span class="sig-paren">(</span><em>particle_pair</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mbuild/compound.html#Compound.add_bond"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mbuild.compound.Compound.add_bond" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a bond between two Particles.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>particle_pair</strong> : indexable object, length=2, dtype=mb.Compound</p>
<blockquote class="last">
<div><p>The pair of Particles to add a bond between</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="mbuild.compound.Compound.all_ports">
<code class="descname">all_ports</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mbuild/compound.html#Compound.all_ports"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mbuild.compound.Compound.all_ports" title="Permalink to this definition">¶</a></dt>
<dd><p>Return all Ports referenced by this Compound and its successors</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">list of mb.Compound</p>
<blockquote class="last">
<div><p>A list of all Ports referenced by this Compound and its successors</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="mbuild.compound.Compound.ancestors">
<code class="descname">ancestors</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mbuild/compound.html#Compound.ancestors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mbuild.compound.Compound.ancestors" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate all ancestors of the Compound recursively.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Yields:</th><td class="field-body"><p class="first">mb.Compound</p>
<blockquote class="last">
<div><p>The next Compound above self in the hierarchy</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="mbuild.compound.Compound.available_ports">
<code class="descname">available_ports</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mbuild/compound.html#Compound.available_ports"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mbuild.compound.Compound.available_ports" title="Permalink to this definition">¶</a></dt>
<dd><p>Return all unoccupied Ports referenced by this Compound.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">list of mb.Compound</p>
<blockquote class="last">
<div><p>A list of all unoccupied ports referenced by the Compound</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="mbuild.compound.Compound.bonds">
<code class="descname">bonds</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mbuild/compound.html#Compound.bonds"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mbuild.compound.Compound.bonds" title="Permalink to this definition">¶</a></dt>
<dd><p>Return all bonds in the Compound and sub-Compounds.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Yields:</th><td class="field-body"><p class="first">tuple of mb.Compound</p>
<blockquote class="last">
<div><p>The next bond in the Compound</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><code class="xref py py-obj docutils literal"><span class="pre">bond_graph.edges_iter</span></code></dt>
<dd>Iterates over all edges in a BondGraph</dd>
</dl>
</div>
</dd></dl>

<dl class="attribute">
<dt id="mbuild.compound.Compound.boundingbox">
<code class="descname">boundingbox</code><a class="headerlink" href="#mbuild.compound.Compound.boundingbox" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the bounding box of the compound.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">mb.Box</p>
<blockquote class="last">
<div><p>The bounding box for this Compound</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="mbuild.compound.Compound.center">
<code class="descname">center</code><a class="headerlink" href="#mbuild.compound.Compound.center" title="Permalink to this definition">¶</a></dt>
<dd><p>The cartesian center of the Compound based on its Particles.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">np.ndarray, shape=(3,), dtype=float</p>
<blockquote class="last">
<div><p>The cartesian center of the Compound based on its Particles</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="mbuild.compound.Compound.contains_rigid">
<code class="descname">contains_rigid</code><a class="headerlink" href="#mbuild.compound.Compound.contains_rigid" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if the Compound contains rigid bodies</p>
<p>If the Compound contains any particle with a rigid_id != None
then contains_rigid will return True. If the Compound has no
children (i.e. the Compound resides at the bottom of the containment
hierarchy) then contains_rigid will return False.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">bool</p>
<blockquote class="last">
<div><p>True if the Compound contains any particle with a rigid_id != None</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>The private variable &#8216;_check_if_contains_rigid_bodies&#8217; is used to help
cache the status of &#8216;contains_rigid&#8217;. If &#8216;_check_if_contains_rigid_bodies&#8217;
is False, then the rigid body containment of the Compound has not changed,
and the particle tree is not traversed, boosting performance.</p>
</dd></dl>

<dl class="method">
<dt id="mbuild.compound.Compound.energy_minimization">
<code class="descname">energy_minimization</code><span class="sig-paren">(</span><em>steps=2500</em>, <em>algorithm='cg'</em>, <em>forcefield='UFF'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mbuild/compound.html#Compound.energy_minimization"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mbuild.compound.Compound.energy_minimization" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform an energy minimization on a Compound</p>
<p>Utilizes Open Babel (<a class="reference external" href="http://openbabel.org/docs/dev/">http://openbabel.org/docs/dev/</a>) to perform an
energy minimization/geometry optimization on a Compound by applying
a generic force field.</p>
<p>This function is primarily intended to be used on smaller components,
with sizes on the order of 10&#8217;s to 100&#8217;s of particles, as the energy
minimization scales poorly with the number of particles.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>steps</strong> : int, optionl, default=1000</p>
<blockquote>
<div><p>The number of optimization iterations</p>
</div></blockquote>
<p><strong>algorithm</strong> : str, optional, default=&#8217;cg&#8217;</p>
<blockquote>
<div><p>The energy minimization algorithm.  Valid options are &#8216;steep&#8217;,
&#8216;cg&#8217;, and &#8216;md&#8217;, corresponding to steepest descent, conjugate
gradient, and equilibrium molecular dynamics respectively.</p>
</div></blockquote>
<p><strong>forcefield</strong> : str, optional, default=&#8217;UFF&#8217;</p>
<blockquote class="last">
<div><p>The generic force field to apply to the Compound for minimization.
Valid options are &#8216;MMFF94&#8217;, &#8216;MMFF94s&#8217;, &#8216;&#8217;UFF&#8217;, &#8216;GAFF&#8217;, and &#8216;Ghemical&#8217;.
Please refer to the Open Babel documentation (<a class="reference external" href="http://open-babel">http://open-babel</a>.
readthedocs.io/en/latest/Forcefields/Overview.html) when considering
your choice of force field.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="r1" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[R1]</a></td><td>O&#8217;Boyle, N.M.; Banck, M.; James, C.A.; Morley, C.;
Vandermeersch, T.; Hutchison, G.R. &#8220;Open Babel: An open
chemical toolbox.&#8221; (2011) J. Cheminf. 3, 33</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="r2" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[R2]</a></td><td>Open Babel, version X.X.X <a class="reference external" href="http://openbabel.org">http://openbabel.org</a>, (installed
Month Year)</td></tr>
</tbody>
</table>
<p>If using the &#8216;MMFF94&#8217; force field please also cite the following:
.. [R3] T.A. Halgren, &#8220;Merck molecular force field. I. Basis, form,</p>
<blockquote>
<div>scope, parameterization, and performance of MMFF94.&#8221; (1996)
J. Comput. Chem. 17, 490-519</div></blockquote>
<table class="docutils citation" frame="void" id="r4" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id4">[R4]</a></td><td>T.A. Halgren, &#8220;Merck molecular force field. II. MMFF94 van der
Waals and electrostatic parameters for intermolecular
interactions.&#8221; (1996) J. Comput. Chem. 17, 520-552</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="r5" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id5">[R5]</a></td><td>T.A. Halgren, &#8220;Merck molecular force field. III. Molecular
geometries and vibrational frequencies for MMFF94.&#8221; (1996)
J. Comput. Chem. 17, 553-586</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="r6" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id6">[R6]</a></td><td>T.A. Halgren and R.B. Nachbar, &#8220;Merck molecular force field.
IV. Conformational energies and geometries for MMFF94.&#8221; (1996)
J. Comput. Chem. 17, 587-615</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="r7" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id7">[R7]</a></td><td>T.A. Halgren, &#8220;Merck molecular force field. V. Extension of
MMFF94 using experimental data, additional computational data,
and empirical rules.&#8221; (1996) J. Comput. Chem. 17, 616-641</td></tr>
</tbody>
</table>
<p>If using the &#8216;MMFF94s&#8217; force field please cite the above along with:
.. [R8] T.A. Halgren, &#8220;MMFF VI. MMFF94s option for energy minimization</p>
<blockquote>
<div>studies.&#8221; (1999) J. Comput. Chem. 20, 720-729</div></blockquote>
<p>If using the &#8216;UFF&#8217; force field please cite the following:
.. [R3] Rappe, A.K., Casewit, C.J., Colwell, K.S., Goddard, W.A. III,</p>
<blockquote>
<div>Skiff, W.M. &#8220;UFF, a full periodic table force field for
molecular mechanics and molecular dynamics simulations.&#8221; (1992)
J. Am. Chem. Soc. 114, 10024-10039</div></blockquote>
<p>If using the &#8216;GAFF&#8217; force field please cite the following:
.. [R3] Wang, J., Wolf, R.M., Caldwell, J.W., Kollman, P.A., Case, D.A.</p>
<blockquote>
<div>&#8220;Development and testing of a general AMBER force field&#8221; (2004)
J. Comput. Chem. 25, 1157-1174</div></blockquote>
<p>If using the &#8216;Ghemical&#8217; force field please cite the following:
.. [R3] T. Hassinen and M. Perakyla, &#8220;New energy terms for reduced</p>
<blockquote>
<div>protein models implemented in an off-lattice force field&#8221; (2001)
J. Comput. Chem. 22, 1229-1242</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="mbuild.compound.Compound.from_parmed">
<code class="descname">from_parmed</code><span class="sig-paren">(</span><em>structure</em>, <em>coords_only=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mbuild/compound.html#Compound.from_parmed"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mbuild.compound.Compound.from_parmed" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract atoms and bonds from a pmd.Structure.</p>
<p>Will create sub-compounds for every chain if there is more than one
and sub-sub-compounds for every residue.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>structure</strong> : pmd.Structure</p>
<blockquote>
<div><p>The structure to load.</p>
</div></blockquote>
<p><strong>coords_only</strong> : bool</p>
<blockquote class="last">
<div><p>Set preexisting atoms in compound to coordinates given by structure.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="mbuild.compound.Compound.from_trajectory">
<code class="descname">from_trajectory</code><span class="sig-paren">(</span><em>traj</em>, <em>frame=-1</em>, <em>coords_only=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mbuild/compound.html#Compound.from_trajectory"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mbuild.compound.Compound.from_trajectory" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract atoms and bonds from a md.Trajectory.</p>
<p>Will create sub-compounds for every chain if there is more than one
and sub-sub-compounds for every residue.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>traj</strong> : mdtraj.Trajectory</p>
<blockquote>
<div><p>The trajectory to load.</p>
</div></blockquote>
<p><strong>frame</strong> : int, optional, default=-1 (last)</p>
<blockquote>
<div><p>The frame to take coordinates from.</p>
</div></blockquote>
<p><strong>coords_only</strong> : bool, optional, default=False</p>
<blockquote class="last">
<div><p>Only read coordinate information</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="mbuild.compound.Compound.generate_bonds">
<code class="descname">generate_bonds</code><span class="sig-paren">(</span><em>name_a</em>, <em>name_b</em>, <em>dmin</em>, <em>dmax</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mbuild/compound.html#Compound.generate_bonds"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mbuild.compound.Compound.generate_bonds" title="Permalink to this definition">¶</a></dt>
<dd><p>Add Bonds between all pairs of types a/b within [dmin, dmax].</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>name_a</strong> : str</p>
<blockquote>
<div><p>The name of one of the Particles to be in each bond</p>
</div></blockquote>
<p><strong>name_b</strong> : str</p>
<blockquote>
<div><p>The name of the other Particle to be in each bond</p>
</div></blockquote>
<p><strong>dmin</strong> : float</p>
<blockquote>
<div><p>The minimum distance between Particles for considering a bond</p>
</div></blockquote>
<p><strong>dmax</strong> : float</p>
<blockquote class="last">
<div><p>The maximum distance between Particles for considering a bond</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="mbuild.compound.Compound.label_rigid_bodies">
<code class="descname">label_rigid_bodies</code><span class="sig-paren">(</span><em>discrete_bodies=None</em>, <em>rigid_particles=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mbuild/compound.html#Compound.label_rigid_bodies"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mbuild.compound.Compound.label_rigid_bodies" title="Permalink to this definition">¶</a></dt>
<dd><p>Designate which Compounds should be treated as rigid bodies</p>
<p>If no arguments are provided, this function will treat the compound
as a single rigid body by providing all particles in <cite>self</cite> with the
same rigid_id. If <cite>discrete_bodies</cite> is not None, each instance of
a Compound with a name found in <cite>discrete_bodies</cite> will be treated as a
unique rigid body. If <cite>rigid_particles</cite> is not None, only Particles
(Compounds at the bottom of the containment hierarchy) matching this name
will be considered part of the rigid body.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>discrete_bodies</strong> : str or list of str, optional, default=None</p>
<blockquote>
<div><p>Name(s) of Compound instances to be treated as unique rigid bodies.
Compound instances matching this (these) name(s) will be provided
with unique rigid_ids</p>
</div></blockquote>
<p><strong>rigid_particles</strong> : str or list of str, optional, default=None</p>
<blockquote class="last">
<div><p>Name(s) of Compound instances at the bottom of the containment
hierarchy (Particles) to be included in rigid bodies. Only Particles
matching this (these) name(s) will have their rigid_ids altered to
match the rigid body number.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<p>Creating a rigid benzene</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mbuild</span> <span class="k">as</span> <span class="nn">mb</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mbuild.utils.io</span> <span class="k">import</span> <span class="n">get_fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">benzene</span> <span class="o">=</span> <span class="n">mb</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">get_fn</span><span class="p">(</span><span class="s1">&#39;benzene.mol2&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">benzene</span><span class="o">.</span><span class="n">label_rigid_bodies</span><span class="p">()</span>
</pre></div>
</div>
<p>Creating a semi-rigid benzene, where only the carbons are treated as
a rigid body</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mbuild</span> <span class="k">as</span> <span class="nn">mb</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mbuild.utils.io</span> <span class="k">import</span> <span class="n">get_fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">benzene</span> <span class="o">=</span> <span class="n">mb</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">get_fn</span><span class="p">(</span><span class="s1">&#39;benzene.mol2&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">benzene</span><span class="o">.</span><span class="n">label_rigid_bodies</span><span class="p">(</span><span class="n">rigid_particles</span><span class="o">=</span><span class="s1">&#39;C&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Create a box of rigid benzenes, where each benzene has a unique rigid
body ID.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mbuild</span> <span class="k">as</span> <span class="nn">mb</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mbuild.utils.io</span> <span class="k">import</span> <span class="n">get_fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">benzene</span> <span class="o">=</span> <span class="n">mb</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">get_fn</span><span class="p">(</span><span class="s1">&#39;benzene.mol2&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">benzene</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Benzene&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filled</span> <span class="o">=</span> <span class="n">mb</span><span class="o">.</span><span class="n">fill_box</span><span class="p">(</span><span class="n">benzene</span><span class="p">,</span>
<span class="gp">... </span>                     <span class="n">n_compounds</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
<span class="gp">... </span>                     <span class="n">box</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filled</span><span class="o">.</span><span class="n">label_rigid_bodies</span><span class="p">(</span><span class="n">distinct_bodies</span><span class="o">=</span><span class="s1">&#39;Benzene&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Create a box of semi-rigid benzenes, where each benzene has a unique
rigid body ID and only the carbon portion is treated as rigid.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mbuild</span> <span class="k">as</span> <span class="nn">mb</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mbuild.utils.io</span> <span class="k">import</span> <span class="n">get_fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">benzene</span> <span class="o">=</span> <span class="n">mb</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">get_fn</span><span class="p">(</span><span class="s1">&#39;benzene.mol2&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">benzene</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Benzene&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filled</span> <span class="o">=</span> <span class="n">mb</span><span class="o">.</span><span class="n">fill_box</span><span class="p">(</span><span class="n">benzene</span><span class="p">,</span>
<span class="gp">... </span>                     <span class="n">n_compounds</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
<span class="gp">... </span>                     <span class="n">box</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filled</span><span class="o">.</span><span class="n">label_rigid_bodies</span><span class="p">(</span><span class="n">distinct_bodies</span><span class="o">=</span><span class="s1">&#39;Benzene&#39;</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">rigid_particles</span><span class="o">=</span><span class="s1">&#39;C&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="mbuild.compound.Compound.max_rigid_id">
<code class="descname">max_rigid_id</code><a class="headerlink" href="#mbuild.compound.Compound.max_rigid_id" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the maximum rigid body ID contained in the Compound.</p>
<p>This is usually used by compound.root to determine the maximum
rigid_id in the containment hierarchy.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">int or None</p>
<blockquote class="last">
<div><p>The maximum rigid body ID contained in the Compound. If no
rigid body IDs are found, None is returned</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="mbuild.compound.Compound.min_periodic_distance">
<code class="descname">min_periodic_distance</code><span class="sig-paren">(</span><em>xyz0</em>, <em>xyz1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mbuild/compound.html#Compound.min_periodic_distance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mbuild.compound.Compound.min_periodic_distance" title="Permalink to this definition">¶</a></dt>
<dd><p>Vectorized distance calculation considering minimum image.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>xyz0</strong> : np.ndarray, shape=(3,), dtype=float</p>
<blockquote>
<div><p>Coordinates of first point</p>
</div></blockquote>
<p><strong>xyz1</strong> : np.ndarray, shape=(3,), dtype=float</p>
<blockquote>
<div><p>Coordinates of second point</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">float</p>
<blockquote class="last">
<div><p>Vectorized distance between the two points following minimum
image convention</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="mbuild.compound.Compound.n_bonds">
<code class="descname">n_bonds</code><a class="headerlink" href="#mbuild.compound.Compound.n_bonds" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the number of bonds in the Compound.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">int</p>
<blockquote class="last">
<div><p>The number of bonds in the Compound</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="mbuild.compound.Compound.n_particles">
<code class="descname">n_particles</code><a class="headerlink" href="#mbuild.compound.Compound.n_particles" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the number of Particles in the Compound.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">int</p>
<blockquote class="last">
<div><p>The number of Particles in the Compound</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="mbuild.compound.Compound.particles">
<code class="descname">particles</code><span class="sig-paren">(</span><em>include_ports=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mbuild/compound.html#Compound.particles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mbuild.compound.Compound.particles" title="Permalink to this definition">¶</a></dt>
<dd><p>Return all Particles of the Compound.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>include_ports</strong> : bool, optional, default=False</p>
<blockquote>
<div><p>Include port particles</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Yields:</th><td class="field-body"><p class="first">mb.Compound</p>
<blockquote class="last">
<div><p>The next Particle in the Compound</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="mbuild.compound.Compound.particles_by_name">
<code class="descname">particles_by_name</code><span class="sig-paren">(</span><em>name</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mbuild/compound.html#Compound.particles_by_name"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mbuild.compound.Compound.particles_by_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Return all Particles of the Compound with a specific name</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>name</strong> : str</p>
<blockquote>
<div><p>Only particles with this name are returned</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Yields:</th><td class="field-body"><p class="first">mb.Compound</p>
<blockquote class="last">
<div><p>The next Particle in the Compound with the user-specified name</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="mbuild.compound.Compound.particles_in_range">
<code class="descname">particles_in_range</code><span class="sig-paren">(</span><em>compound</em>, <em>dmax</em>, <em>max_particles=20</em>, <em>particle_kdtree=None</em>, <em>particle_array=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mbuild/compound.html#Compound.particles_in_range"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mbuild.compound.Compound.particles_in_range" title="Permalink to this definition">¶</a></dt>
<dd><p>Find particles within a specified range of another particle.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>compound</strong> : mb.Compound</p>
<blockquote>
<div><p>Reference particle to find other particles in range of</p>
</div></blockquote>
<p><strong>dmax</strong> : float</p>
<blockquote>
<div><p>Maximum distance from &#8216;compound&#8217; to look for Particles</p>
</div></blockquote>
<p><strong>max_particles</strong> : int, optional, default=20</p>
<blockquote>
<div><p>Maximum number of Particles to return</p>
</div></blockquote>
<p><strong>particle_kdtree</strong> : mb.PeriodicCKDTree, optional</p>
<blockquote>
<div><p>KD-tree for looking up nearest neighbors. If not provided, a KD-
tree will be generated from all Particles in self</p>
</div></blockquote>
<p><strong>particle_array</strong> : np.ndarray, shape=(n,), dtype=mb.Compound, optional</p>
<blockquote>
<div><p>Array of possible particles to consider for return. If not
provided, this defaults to all Particles in self</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">np.ndarray, shape=(n,), dtype=mb.Compound</p>
<blockquote class="last">
<div><p>Particles in range of compound according to user-defined limits</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><code class="xref py py-obj docutils literal"><span class="pre">periodic_kdtree.PerioidicCKDTree</span></code></dt>
<dd>mBuild implementation of kd-trees</dd>
<dt><code class="xref py py-obj docutils literal"><span class="pre">scipy.spatial.ckdtree</span></code></dt>
<dd>Further details on kd-trees</dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="mbuild.compound.Compound.referenced_ports">
<code class="descname">referenced_ports</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mbuild/compound.html#Compound.referenced_ports"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mbuild.compound.Compound.referenced_ports" title="Permalink to this definition">¶</a></dt>
<dd><p>Return all Ports referenced by this Compound.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">list of mb.Compound</p>
<blockquote class="last">
<div><p>A list of all ports referenced by the Compound</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="mbuild.compound.Compound.remove">
<code class="descname">remove</code><span class="sig-paren">(</span><em>objs_to_remove</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mbuild/compound.html#Compound.remove"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mbuild.compound.Compound.remove" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove children from the Compound.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>objs_to_remove</strong> : mb.Compound or list of mb.Compound</p>
<blockquote class="last">
<div><p>The Compound(s) to be removed from self</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="mbuild.compound.Compound.remove_bond">
<code class="descname">remove_bond</code><span class="sig-paren">(</span><em>particle_pair</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mbuild/compound.html#Compound.remove_bond"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mbuild.compound.Compound.remove_bond" title="Permalink to this definition">¶</a></dt>
<dd><p>Deletes a bond between a pair of Particles</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>particle_pair</strong> : indexable object, length=2, dtype=mb.Compound</p>
<blockquote class="last">
<div><p>The pair of Particles to remove the bond between</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="mbuild.compound.Compound.rigid_particles">
<code class="descname">rigid_particles</code><span class="sig-paren">(</span><em>rigid_id=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mbuild/compound.html#Compound.rigid_particles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mbuild.compound.Compound.rigid_particles" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate all particles in rigid bodies.</p>
<p>If a rigid_id is specified, then this function will only yield particles
with a matching rigid_id.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>rigid_id</strong> : int, optional</p>
<blockquote>
<div><p>Include only particles with this rigid body ID</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Yields:</th><td class="field-body"><p class="first">mb.Compound</p>
<blockquote class="last">
<div><p>The next particle with a rigid_id that is not None, or the next
particle with a matching rigid_id if specified</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="mbuild.compound.Compound.root">
<code class="descname">root</code><a class="headerlink" href="#mbuild.compound.Compound.root" title="Permalink to this definition">¶</a></dt>
<dd><p>The Compound at the top of self&#8217;s hierarchy.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">mb.Compound</p>
<blockquote class="last">
<div><p>The Compound at the top of self&#8217;s hierarchy</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="mbuild.compound.Compound.rotate">
<code class="descname">rotate</code><span class="sig-paren">(</span><em>theta</em>, <em>around</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mbuild/compound.html#Compound.rotate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mbuild.compound.Compound.rotate" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotate Compound around an arbitrary vector.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>theta</strong> : float</p>
<blockquote>
<div><p>The angle by which to rotate the Compound, in radians.</p>
</div></blockquote>
<p><strong>around</strong> : np.ndarray, shape=(3,), dtype=float</p>
<blockquote class="last">
<div><p>The vector about which to rotate the Compound.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="mbuild.compound.Compound.save">
<code class="descname">save</code><span class="sig-paren">(</span><em>filename</em>, <em>show_ports=False</em>, <em>forcefield_name=None</em>, <em>forcefield_files=None</em>, <em>box=None</em>, <em>overwrite=False</em>, <em>residues=None</em>, <em>references_file=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mbuild/compound.html#Compound.save"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mbuild.compound.Compound.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the Compound to a file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filename</strong> : str</p>
<blockquote>
<div><p>Filesystem path in which to save the trajectory. The extension or
prefix will be parsed and control the format. Supported
extensions are: &#8216;hoomdxml&#8217;, &#8216;gsd&#8217;, &#8216;gro&#8217;, &#8216;top&#8217;, &#8216;lammps&#8217;, &#8216;lmp&#8217;</p>
</div></blockquote>
<p><strong>show_ports</strong> : bool, optional, default=False</p>
<blockquote>
<div><p>Save ports contained within the compound.</p>
</div></blockquote>
<p><strong>forcefield_file</strong> : str, optional, default=None</p>
<blockquote>
<div><p>Apply a forcefield to the output file using a forcefield provided
by the <cite>foyer</cite> package.</p>
</div></blockquote>
<p><strong>forcefield_name</strong> : str, optional, default=None</p>
<blockquote>
<div><p>Apply a named forcefield to the output file using the <cite>foyer</cite>
package, e.g. &#8216;oplsaa&#8217;. Forcefields listed here:
<a class="reference external" href="https://github.com/mosdef-hub/foyer/tree/master/foyer/forcefields">https://github.com/mosdef-hub/foyer/tree/master/foyer/forcefields</a></p>
</div></blockquote>
<p><strong>box</strong> : mb.Box, optional, default=self.boundingbox (with buffer)</p>
<blockquote>
<div><p>Box information to be written to the output file. If &#8216;None&#8217;, a
bounding box is used with 0.25nm buffers at each face to avoid
overlapping atoms.</p>
</div></blockquote>
<p><strong>overwrite</strong> : bool, optional, default=False</p>
<blockquote>
<div><p>Overwrite if the filename already exists</p>
</div></blockquote>
<p><strong>residues</strong> : str of list of str</p>
<blockquote>
<div><p>Labels of residues in the Compound. Residues are assigned by
checking against Compound.name.</p>
</div></blockquote>
<p><strong>references_file</strong> : str, optional, default=None</p>
<blockquote>
<div><p>Specify a filename to write references for the forcefield that is
to be applied. References are written in BiBTeX format.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Other Parameters:</th></tr>
<tr class="field-even field"><td>&#160;</td><td class="field-body"><p class="first"><strong>ref_distance</strong> : float, optional, default=1.0</p>
<blockquote>
<div><p>Normalization factor used when saving to .gsd and .hoomdxml formats
for converting distance values to reduced units.</p>
</div></blockquote>
<p><strong>ref_energy</strong> : float, optional, default=1.0</p>
<blockquote>
<div><p>Normalization factor used when saving to .gsd and .hoomdxml formats
for converting energy values to reduced units.</p>
</div></blockquote>
<p><strong>ref_mass</strong> : float, optional, default=1.0</p>
<blockquote class="last">
<div><p>Normalization factor used when saving to .gsd and .hoomdxml formats
for converting mass values to reduced units.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><code class="xref py py-obj docutils literal"><span class="pre">formats.gsdwrite.write_gsd</span></code></dt>
<dd>Write to GSD format</dd>
<dt><code class="xref py py-obj docutils literal"><span class="pre">formats.hoomdxml.write_hoomdxml</span></code></dt>
<dd>Write to Hoomd XML format</dd>
<dt><code class="xref py py-obj docutils literal"><span class="pre">formats.lammpsdata.write_lammpsdata</span></code></dt>
<dd>Write to LAMMPS data format</dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="mbuild.compound.Compound.spin">
<code class="descname">spin</code><span class="sig-paren">(</span><em>theta</em>, <em>around</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mbuild/compound.html#Compound.spin"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mbuild.compound.Compound.spin" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotate Compound in place around an arbitrary vector.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>theta</strong> : float</p>
<blockquote>
<div><p>The angle by which to rotate the Compound, in radians.</p>
</div></blockquote>
<p><strong>around</strong> : np.ndarray, shape=(3,), dtype=float</p>
<blockquote class="last">
<div><p>The axis about which to spin the Compound.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="mbuild.compound.Compound.successors">
<code class="descname">successors</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mbuild/compound.html#Compound.successors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mbuild.compound.Compound.successors" title="Permalink to this definition">¶</a></dt>
<dd><p>Yield Compounds below self in the hierarchy.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Yields:</th><td class="field-body"><p class="first">mb.Compound</p>
<blockquote class="last">
<div><p>The next Particle below self in the hierarchy</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="mbuild.compound.Compound.to_intermol">
<code class="descname">to_intermol</code><span class="sig-paren">(</span><em>molecule_types=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mbuild/compound.html#Compound.to_intermol"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mbuild.compound.Compound.to_intermol" title="Permalink to this definition">¶</a></dt>
<dd><p>Create an InterMol system from a Compound.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>molecule_types</strong> : list or tuple of subclasses of Compound</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>intermol_system</strong> : intermol.system.System</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="mbuild.compound.Compound.to_parmed">
<code class="descname">to_parmed</code><span class="sig-paren">(</span><em>box=None</em>, <em>title=''</em>, <em>residues=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mbuild/compound.html#Compound.to_parmed"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mbuild.compound.Compound.to_parmed" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a ParmEd Structure from a Compound.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>title</strong> : str, optional, default=self.name</p>
<blockquote>
<div><p>Title/name of the ParmEd Structure</p>
</div></blockquote>
<p><strong>residues</strong> : str of list of str</p>
<blockquote>
<div><p>Labels of residues in the Compound. Residues are assigned by
checking against Compound.name.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">parmed.structure.Structure</p>
<blockquote class="last">
<div><p>ParmEd Structure object converted from self</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><code class="xref py py-obj docutils literal"><span class="pre">parmed.structure.Structure</span></code></dt>
<dd>Details on the ParmEd Structure object</dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="mbuild.compound.Compound.to_trajectory">
<code class="descname">to_trajectory</code><span class="sig-paren">(</span><em>show_ports=False</em>, <em>chains=None</em>, <em>residues=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mbuild/compound.html#Compound.to_trajectory"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mbuild.compound.Compound.to_trajectory" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert to an md.Trajectory and flatten the compound.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>show_ports</strong> : bool, optional, default=False</p>
<blockquote>
<div><p>Include all port atoms when converting to trajectory.</p>
</div></blockquote>
<p><strong>chains</strong> : mb.Compound or list of mb.Compound</p>
<blockquote>
<div><p>Chain types to add to the topology</p>
</div></blockquote>
<p><strong>residues</strong> : str of list of str</p>
<blockquote>
<div><p>Labels of residues in the Compound. Residues are assigned by
checking against Compound.name.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>trajectory</strong> : md.Trajectory</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><code class="xref py py-obj docutils literal"><span class="pre">_to_topology</span></code></p>
</div>
</dd></dl>

<dl class="method">
<dt id="mbuild.compound.Compound.translate">
<code class="descname">translate</code><span class="sig-paren">(</span><em>by</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mbuild/compound.html#Compound.translate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mbuild.compound.Compound.translate" title="Permalink to this definition">¶</a></dt>
<dd><p>Translate the Compound by a vector</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>by</strong> : np.ndarray, shape=(3,), dtype=float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="mbuild.compound.Compound.translate_to">
<code class="descname">translate_to</code><span class="sig-paren">(</span><em>pos</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mbuild/compound.html#Compound.translate_to"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mbuild.compound.Compound.translate_to" title="Permalink to this definition">¶</a></dt>
<dd><p>Translate the Compound to a specific position</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pos</strong> : np.ndarray, shape=3(,), dtype=float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="mbuild.compound.Compound.unlabel_rigid_bodies">
<code class="descname">unlabel_rigid_bodies</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mbuild/compound.html#Compound.unlabel_rigid_bodies"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mbuild.compound.Compound.unlabel_rigid_bodies" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove all rigid body labels from the Compound</p>
</dd></dl>

<dl class="method">
<dt id="mbuild.compound.Compound.update_coordinates">
<code class="descname">update_coordinates</code><span class="sig-paren">(</span><em>filename</em>, <em>update_port_locations=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mbuild/compound.html#Compound.update_coordinates"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mbuild.compound.Compound.update_coordinates" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the coordinates of this Compound from a file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filename</strong> : str</p>
<blockquote>
<div><p>Name of file from which to load coordinates. Supported file types
are the same as those supported by load()</p>
</div></blockquote>
<p><strong>update_port_locations</strong> : bool, optional, default=True</p>
<blockquote class="last">
<div><p>Update the locations of Ports so that they are shifted along with
their anchor particles.  Note: This conserves the location of
Ports with respect to the anchor Particle, but does not conserve
the orientation of Ports with respect to the molecule as a whole.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><code class="xref py py-obj docutils literal"><span class="pre">load</span></code></dt>
<dd>Load coordinates from a file</dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="mbuild.compound.Compound.visualize">
<code class="descname">visualize</code><span class="sig-paren">(</span><em>show_ports=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mbuild/compound.html#Compound.visualize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mbuild.compound.Compound.visualize" title="Permalink to this definition">¶</a></dt>
<dd><p>Visualize the Compound using nglview.</p>
<p>Allows for visualization of a Compound within a Jupyter Notebook.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>show_ports</strong> : bool, optional, default=False</p>
<blockquote class="last">
<div><p>Visualize Ports in addition to Particles</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="mbuild.compound.Compound.xyz">
<code class="descname">xyz</code><a class="headerlink" href="#mbuild.compound.Compound.xyz" title="Permalink to this definition">¶</a></dt>
<dd><p>Return all particle coordinates in this compound.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>pos</strong> : np.ndarray, shape=(n, 3), dtype=float</p>
<blockquote class="last">
<div><p>Array with the positions of all particles.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="mbuild.compound.Compound.xyz_with_ports">
<code class="descname">xyz_with_ports</code><a class="headerlink" href="#mbuild.compound.Compound.xyz_with_ports" title="Permalink to this definition">¶</a></dt>
<dd><p>Return all particle coordinates in this compound including ports.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>pos</strong> : np.ndarray, shape=(n, 3), dtype=float</p>
<blockquote class="last">
<div><p>Array with the positions of all particles and ports.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="port">
<h2>Port<a class="headerlink" href="#port" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="mbuild.port.Port">
<em class="property">class </em><code class="descclassname">mbuild.port.</code><code class="descname">Port</code><span class="sig-paren">(</span><em>anchor=None</em>, <em>orientation=None</em>, <em>separation=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mbuild/port.html#Port"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mbuild.port.Port" title="Permalink to this definition">¶</a></dt>
<dd><p>A set of four ghost Particles used to connect parts.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>anchor</strong> : mb.Particle, optional, default=None</p>
<blockquote class="last">
<div><p>A Particle associated with the port. Used to form bonds.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Attributes</p>
<table border="1" class="docutils">
<colgroup>
<col width="4%" />
<col width="96%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>anchor</td>
<td>(mb.Particle, optional, default=None) A Particle associated with the port. Used to form bonds.</td>
</tr>
<tr class="row-even"><td>up</td>
<td>(mb.Compound) Collection of 4 ghost particles used to perform equivalence transforms. Faces the opposite direction as self[&#8216;down&#8217;].</td>
</tr>
<tr class="row-odd"><td>down</td>
<td>(mb.Compound) Collection of 4 ghost particles used to perform equivalence transforms. Faces the opposite direction as self[&#8216;up&#8217;].</td>
</tr>
<tr class="row-even"><td>used</td>
<td>(bool) Status of whether a port has been occupied following an equivalence transform.</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="mbuild.port.Port.add">
<code class="descname">add</code><span class="sig-paren">(</span><em>new_child</em>, <em>label=None</em>, <em>containment=True</em>, <em>replace=False</em>, <em>inherit_periodicity=True</em>, <em>reset_rigid_ids=True</em><span class="sig-paren">)</span><a class="headerlink" href="#mbuild.port.Port.add" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a part to the Compound.</p>
<dl class="docutils">
<dt>Note:</dt>
<dd>This does not necessarily add the part to self.children but may
instead be used to add a reference to the part to self.labels. See
&#8216;containment&#8217; argument.</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>new_child</strong> : mb.Compound or list-like of mb.Compound</p>
<blockquote>
<div><p>The object(s) to be added to this Compound.</p>
</div></blockquote>
<p><strong>label</strong> : str, optional</p>
<blockquote>
<div><p>A descriptive string for the part.</p>
</div></blockquote>
<p><strong>containment</strong> : bool, optional, default=True</p>
<blockquote>
<div><p>Add the part to self.children.</p>
</div></blockquote>
<p><strong>replace</strong> : bool, optional, default=True</p>
<blockquote>
<div><p>Replace the label if it already exists.</p>
</div></blockquote>
<p><strong>inherit_periodicity</strong> : bool, optional, default=True</p>
<blockquote>
<div><p>Replace the periodicity of self with the periodicity of the
Compound being added</p>
</div></blockquote>
<p><strong>reset_rigid_ids</strong> : bool, optional, default=True</p>
<blockquote class="last">
<div><p>If the Compound to be added contains rigid bodies, reset the
rigid_ids such that values remain distinct from rigid_ids
already present in <cite>self</cite>. Can be set to False if attempting
to add Compounds to an existing rigid body.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="mbuild.port.Port.add_bond">
<code class="descname">add_bond</code><span class="sig-paren">(</span><em>particle_pair</em><span class="sig-paren">)</span><a class="headerlink" href="#mbuild.port.Port.add_bond" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a bond between two Particles.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>particle_pair</strong> : indexable object, length=2, dtype=mb.Compound</p>
<blockquote class="last">
<div><p>The pair of Particles to add a bond between</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="mbuild.port.Port.all_ports">
<code class="descname">all_ports</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mbuild.port.Port.all_ports" title="Permalink to this definition">¶</a></dt>
<dd><p>Return all Ports referenced by this Compound and its successors</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">list of mb.Compound</p>
<blockquote class="last">
<div><p>A list of all Ports referenced by this Compound and its successors</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="mbuild.port.Port.ancestors">
<code class="descname">ancestors</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mbuild.port.Port.ancestors" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate all ancestors of the Compound recursively.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Yields:</th><td class="field-body"><p class="first">mb.Compound</p>
<blockquote class="last">
<div><p>The next Compound above self in the hierarchy</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="mbuild.port.Port.available_ports">
<code class="descname">available_ports</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mbuild.port.Port.available_ports" title="Permalink to this definition">¶</a></dt>
<dd><p>Return all unoccupied Ports referenced by this Compound.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">list of mb.Compound</p>
<blockquote class="last">
<div><p>A list of all unoccupied ports referenced by the Compound</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="mbuild.port.Port.bonds">
<code class="descname">bonds</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mbuild.port.Port.bonds" title="Permalink to this definition">¶</a></dt>
<dd><p>Return all bonds in the Compound and sub-Compounds.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Yields:</th><td class="field-body"><p class="first">tuple of mb.Compound</p>
<blockquote class="last">
<div><p>The next bond in the Compound</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><code class="xref py py-obj docutils literal"><span class="pre">bond_graph.edges_iter</span></code></dt>
<dd>Iterates over all edges in a BondGraph</dd>
</dl>
</div>
</dd></dl>

<dl class="attribute">
<dt id="mbuild.port.Port.boundingbox">
<code class="descname">boundingbox</code><a class="headerlink" href="#mbuild.port.Port.boundingbox" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the bounding box of the compound.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">mb.Box</p>
<blockquote class="last">
<div><p>The bounding box for this Compound</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="mbuild.port.Port.center">
<code class="descname">center</code><a class="headerlink" href="#mbuild.port.Port.center" title="Permalink to this definition">¶</a></dt>
<dd><p>The cartesian center of the Port</p>
</dd></dl>

<dl class="attribute">
<dt id="mbuild.port.Port.contains_rigid">
<code class="descname">contains_rigid</code><a class="headerlink" href="#mbuild.port.Port.contains_rigid" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if the Compound contains rigid bodies</p>
<p>If the Compound contains any particle with a rigid_id != None
then contains_rigid will return True. If the Compound has no
children (i.e. the Compound resides at the bottom of the containment
hierarchy) then contains_rigid will return False.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">bool</p>
<blockquote class="last">
<div><p>True if the Compound contains any particle with a rigid_id != None</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>The private variable &#8216;_check_if_contains_rigid_bodies&#8217; is used to help
cache the status of &#8216;contains_rigid&#8217;. If &#8216;_check_if_contains_rigid_bodies&#8217;
is False, then the rigid body containment of the Compound has not changed,
and the particle tree is not traversed, boosting performance.</p>
</dd></dl>

<dl class="attribute">
<dt id="mbuild.port.Port.direction">
<code class="descname">direction</code><a class="headerlink" href="#mbuild.port.Port.direction" title="Permalink to this definition">¶</a></dt>
<dd><p>The unit vector pointing in the &#8216;direction&#8217; of the Port</p>
</dd></dl>

<dl class="method">
<dt id="mbuild.port.Port.energy_minimization">
<code class="descname">energy_minimization</code><span class="sig-paren">(</span><em>steps=2500</em>, <em>algorithm='cg'</em>, <em>forcefield='UFF'</em><span class="sig-paren">)</span><a class="headerlink" href="#mbuild.port.Port.energy_minimization" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform an energy minimization on a Compound</p>
<p>Utilizes Open Babel (<a class="reference external" href="http://openbabel.org/docs/dev/">http://openbabel.org/docs/dev/</a>) to perform an
energy minimization/geometry optimization on a Compound by applying
a generic force field.</p>
<p>This function is primarily intended to be used on smaller components,
with sizes on the order of 10&#8217;s to 100&#8217;s of particles, as the energy
minimization scales poorly with the number of particles.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>steps</strong> : int, optionl, default=1000</p>
<blockquote>
<div><p>The number of optimization iterations</p>
</div></blockquote>
<p><strong>algorithm</strong> : str, optional, default=&#8217;cg&#8217;</p>
<blockquote>
<div><p>The energy minimization algorithm.  Valid options are &#8216;steep&#8217;,
&#8216;cg&#8217;, and &#8216;md&#8217;, corresponding to steepest descent, conjugate
gradient, and equilibrium molecular dynamics respectively.</p>
</div></blockquote>
<p><strong>forcefield</strong> : str, optional, default=&#8217;UFF&#8217;</p>
<blockquote class="last">
<div><p>The generic force field to apply to the Compound for minimization.
Valid options are &#8216;MMFF94&#8217;, &#8216;MMFF94s&#8217;, &#8216;&#8217;UFF&#8217;, &#8216;GAFF&#8217;, and &#8216;Ghemical&#8217;.
Please refer to the Open Babel documentation (<a class="reference external" href="http://open-babel">http://open-babel</a>.
readthedocs.io/en/latest/Forcefields/Overview.html) when considering
your choice of force field.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="r12" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id12">[R12]</a></td><td>O&#8217;Boyle, N.M.; Banck, M.; James, C.A.; Morley, C.;
Vandermeersch, T.; Hutchison, G.R. &#8220;Open Babel: An open
chemical toolbox.&#8221; (2011) J. Cheminf. 3, 33</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="r13" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id13">[R13]</a></td><td>Open Babel, version X.X.X <a class="reference external" href="http://openbabel.org">http://openbabel.org</a>, (installed
Month Year)</td></tr>
</tbody>
</table>
<p>If using the &#8216;MMFF94&#8217; force field please also cite the following:
.. [R14] T.A. Halgren, &#8220;Merck molecular force field. I. Basis, form,</p>
<blockquote>
<div>scope, parameterization, and performance of MMFF94.&#8221; (1996)
J. Comput. Chem. 17, 490-519</div></blockquote>
<table class="docutils citation" frame="void" id="r15" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id15">[R15]</a></td><td>T.A. Halgren, &#8220;Merck molecular force field. II. MMFF94 van der
Waals and electrostatic parameters for intermolecular
interactions.&#8221; (1996) J. Comput. Chem. 17, 520-552</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="r16" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id16">[R16]</a></td><td>T.A. Halgren, &#8220;Merck molecular force field. III. Molecular
geometries and vibrational frequencies for MMFF94.&#8221; (1996)
J. Comput. Chem. 17, 553-586</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="r17" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id17">[R17]</a></td><td>T.A. Halgren and R.B. Nachbar, &#8220;Merck molecular force field.
IV. Conformational energies and geometries for MMFF94.&#8221; (1996)
J. Comput. Chem. 17, 587-615</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="r18" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id18">[R18]</a></td><td>T.A. Halgren, &#8220;Merck molecular force field. V. Extension of
MMFF94 using experimental data, additional computational data,
and empirical rules.&#8221; (1996) J. Comput. Chem. 17, 616-641</td></tr>
</tbody>
</table>
<p>If using the &#8216;MMFF94s&#8217; force field please cite the above along with:
.. [R19] T.A. Halgren, &#8220;MMFF VI. MMFF94s option for energy minimization</p>
<blockquote>
<div>studies.&#8221; (1999) J. Comput. Chem. 20, 720-729</div></blockquote>
<p>If using the &#8216;UFF&#8217; force field please cite the following:
.. [R14] Rappe, A.K., Casewit, C.J., Colwell, K.S., Goddard, W.A. III,</p>
<blockquote>
<div>Skiff, W.M. &#8220;UFF, a full periodic table force field for
molecular mechanics and molecular dynamics simulations.&#8221; (1992)
J. Am. Chem. Soc. 114, 10024-10039</div></blockquote>
<p>If using the &#8216;GAFF&#8217; force field please cite the following:
.. [R14] Wang, J., Wolf, R.M., Caldwell, J.W., Kollman, P.A., Case, D.A.</p>
<blockquote>
<div>&#8220;Development and testing of a general AMBER force field&#8221; (2004)
J. Comput. Chem. 25, 1157-1174</div></blockquote>
<p>If using the &#8216;Ghemical&#8217; force field please cite the following:
.. [R14] T. Hassinen and M. Perakyla, &#8220;New energy terms for reduced</p>
<blockquote>
<div>protein models implemented in an off-lattice force field&#8221; (2001)
J. Comput. Chem. 22, 1229-1242</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="mbuild.port.Port.from_parmed">
<code class="descname">from_parmed</code><span class="sig-paren">(</span><em>structure</em>, <em>coords_only=False</em><span class="sig-paren">)</span><a class="headerlink" href="#mbuild.port.Port.from_parmed" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract atoms and bonds from a pmd.Structure.</p>
<p>Will create sub-compounds for every chain if there is more than one
and sub-sub-compounds for every residue.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>structure</strong> : pmd.Structure</p>
<blockquote>
<div><p>The structure to load.</p>
</div></blockquote>
<p><strong>coords_only</strong> : bool</p>
<blockquote class="last">
<div><p>Set preexisting atoms in compound to coordinates given by structure.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="mbuild.port.Port.from_trajectory">
<code class="descname">from_trajectory</code><span class="sig-paren">(</span><em>traj</em>, <em>frame=-1</em>, <em>coords_only=False</em><span class="sig-paren">)</span><a class="headerlink" href="#mbuild.port.Port.from_trajectory" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract atoms and bonds from a md.Trajectory.</p>
<p>Will create sub-compounds for every chain if there is more than one
and sub-sub-compounds for every residue.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>traj</strong> : mdtraj.Trajectory</p>
<blockquote>
<div><p>The trajectory to load.</p>
</div></blockquote>
<p><strong>frame</strong> : int, optional, default=-1 (last)</p>
<blockquote>
<div><p>The frame to take coordinates from.</p>
</div></blockquote>
<p><strong>coords_only</strong> : bool, optional, default=False</p>
<blockquote class="last">
<div><p>Only read coordinate information</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="mbuild.port.Port.generate_bonds">
<code class="descname">generate_bonds</code><span class="sig-paren">(</span><em>name_a</em>, <em>name_b</em>, <em>dmin</em>, <em>dmax</em><span class="sig-paren">)</span><a class="headerlink" href="#mbuild.port.Port.generate_bonds" title="Permalink to this definition">¶</a></dt>
<dd><p>Add Bonds between all pairs of types a/b within [dmin, dmax].</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>name_a</strong> : str</p>
<blockquote>
<div><p>The name of one of the Particles to be in each bond</p>
</div></blockquote>
<p><strong>name_b</strong> : str</p>
<blockquote>
<div><p>The name of the other Particle to be in each bond</p>
</div></blockquote>
<p><strong>dmin</strong> : float</p>
<blockquote>
<div><p>The minimum distance between Particles for considering a bond</p>
</div></blockquote>
<p><strong>dmax</strong> : float</p>
<blockquote class="last">
<div><p>The maximum distance between Particles for considering a bond</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="mbuild.port.Port.label_rigid_bodies">
<code class="descname">label_rigid_bodies</code><span class="sig-paren">(</span><em>discrete_bodies=None</em>, <em>rigid_particles=None</em><span class="sig-paren">)</span><a class="headerlink" href="#mbuild.port.Port.label_rigid_bodies" title="Permalink to this definition">¶</a></dt>
<dd><p>Designate which Compounds should be treated as rigid bodies</p>
<p>If no arguments are provided, this function will treat the compound
as a single rigid body by providing all particles in <cite>self</cite> with the
same rigid_id. If <cite>discrete_bodies</cite> is not None, each instance of
a Compound with a name found in <cite>discrete_bodies</cite> will be treated as a
unique rigid body. If <cite>rigid_particles</cite> is not None, only Particles
(Compounds at the bottom of the containment hierarchy) matching this name
will be considered part of the rigid body.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>discrete_bodies</strong> : str or list of str, optional, default=None</p>
<blockquote>
<div><p>Name(s) of Compound instances to be treated as unique rigid bodies.
Compound instances matching this (these) name(s) will be provided
with unique rigid_ids</p>
</div></blockquote>
<p><strong>rigid_particles</strong> : str or list of str, optional, default=None</p>
<blockquote class="last">
<div><p>Name(s) of Compound instances at the bottom of the containment
hierarchy (Particles) to be included in rigid bodies. Only Particles
matching this (these) name(s) will have their rigid_ids altered to
match the rigid body number.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<p>Creating a rigid benzene</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mbuild</span> <span class="k">as</span> <span class="nn">mb</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mbuild.utils.io</span> <span class="k">import</span> <span class="n">get_fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">benzene</span> <span class="o">=</span> <span class="n">mb</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">get_fn</span><span class="p">(</span><span class="s1">&#39;benzene.mol2&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">benzene</span><span class="o">.</span><span class="n">label_rigid_bodies</span><span class="p">()</span>
</pre></div>
</div>
<p>Creating a semi-rigid benzene, where only the carbons are treated as
a rigid body</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mbuild</span> <span class="k">as</span> <span class="nn">mb</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mbuild.utils.io</span> <span class="k">import</span> <span class="n">get_fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">benzene</span> <span class="o">=</span> <span class="n">mb</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">get_fn</span><span class="p">(</span><span class="s1">&#39;benzene.mol2&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">benzene</span><span class="o">.</span><span class="n">label_rigid_bodies</span><span class="p">(</span><span class="n">rigid_particles</span><span class="o">=</span><span class="s1">&#39;C&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Create a box of rigid benzenes, where each benzene has a unique rigid
body ID.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mbuild</span> <span class="k">as</span> <span class="nn">mb</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mbuild.utils.io</span> <span class="k">import</span> <span class="n">get_fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">benzene</span> <span class="o">=</span> <span class="n">mb</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">get_fn</span><span class="p">(</span><span class="s1">&#39;benzene.mol2&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">benzene</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Benzene&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filled</span> <span class="o">=</span> <span class="n">mb</span><span class="o">.</span><span class="n">fill_box</span><span class="p">(</span><span class="n">benzene</span><span class="p">,</span>
<span class="gp">... </span>                     <span class="n">n_compounds</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
<span class="gp">... </span>                     <span class="n">box</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filled</span><span class="o">.</span><span class="n">label_rigid_bodies</span><span class="p">(</span><span class="n">distinct_bodies</span><span class="o">=</span><span class="s1">&#39;Benzene&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Create a box of semi-rigid benzenes, where each benzene has a unique
rigid body ID and only the carbon portion is treated as rigid.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mbuild</span> <span class="k">as</span> <span class="nn">mb</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mbuild.utils.io</span> <span class="k">import</span> <span class="n">get_fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">benzene</span> <span class="o">=</span> <span class="n">mb</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">get_fn</span><span class="p">(</span><span class="s1">&#39;benzene.mol2&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">benzene</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Benzene&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filled</span> <span class="o">=</span> <span class="n">mb</span><span class="o">.</span><span class="n">fill_box</span><span class="p">(</span><span class="n">benzene</span><span class="p">,</span>
<span class="gp">... </span>                     <span class="n">n_compounds</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
<span class="gp">... </span>                     <span class="n">box</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filled</span><span class="o">.</span><span class="n">label_rigid_bodies</span><span class="p">(</span><span class="n">distinct_bodies</span><span class="o">=</span><span class="s1">&#39;Benzene&#39;</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">rigid_particles</span><span class="o">=</span><span class="s1">&#39;C&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="mbuild.port.Port.max_rigid_id">
<code class="descname">max_rigid_id</code><a class="headerlink" href="#mbuild.port.Port.max_rigid_id" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the maximum rigid body ID contained in the Compound.</p>
<p>This is usually used by compound.root to determine the maximum
rigid_id in the containment hierarchy.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">int or None</p>
<blockquote class="last">
<div><p>The maximum rigid body ID contained in the Compound. If no
rigid body IDs are found, None is returned</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="mbuild.port.Port.min_periodic_distance">
<code class="descname">min_periodic_distance</code><span class="sig-paren">(</span><em>xyz0</em>, <em>xyz1</em><span class="sig-paren">)</span><a class="headerlink" href="#mbuild.port.Port.min_periodic_distance" title="Permalink to this definition">¶</a></dt>
<dd><p>Vectorized distance calculation considering minimum image.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>xyz0</strong> : np.ndarray, shape=(3,), dtype=float</p>
<blockquote>
<div><p>Coordinates of first point</p>
</div></blockquote>
<p><strong>xyz1</strong> : np.ndarray, shape=(3,), dtype=float</p>
<blockquote>
<div><p>Coordinates of second point</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">float</p>
<blockquote class="last">
<div><p>Vectorized distance between the two points following minimum
image convention</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="mbuild.port.Port.n_bonds">
<code class="descname">n_bonds</code><a class="headerlink" href="#mbuild.port.Port.n_bonds" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the number of bonds in the Compound.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">int</p>
<blockquote class="last">
<div><p>The number of bonds in the Compound</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="mbuild.port.Port.n_particles">
<code class="descname">n_particles</code><a class="headerlink" href="#mbuild.port.Port.n_particles" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the number of Particles in the Compound.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">int</p>
<blockquote class="last">
<div><p>The number of Particles in the Compound</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="mbuild.port.Port.particles">
<code class="descname">particles</code><span class="sig-paren">(</span><em>include_ports=False</em><span class="sig-paren">)</span><a class="headerlink" href="#mbuild.port.Port.particles" title="Permalink to this definition">¶</a></dt>
<dd><p>Return all Particles of the Compound.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>include_ports</strong> : bool, optional, default=False</p>
<blockquote>
<div><p>Include port particles</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Yields:</th><td class="field-body"><p class="first">mb.Compound</p>
<blockquote class="last">
<div><p>The next Particle in the Compound</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="mbuild.port.Port.particles_by_name">
<code class="descname">particles_by_name</code><span class="sig-paren">(</span><em>name</em><span class="sig-paren">)</span><a class="headerlink" href="#mbuild.port.Port.particles_by_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Return all Particles of the Compound with a specific name</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>name</strong> : str</p>
<blockquote>
<div><p>Only particles with this name are returned</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Yields:</th><td class="field-body"><p class="first">mb.Compound</p>
<blockquote class="last">
<div><p>The next Particle in the Compound with the user-specified name</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="mbuild.port.Port.particles_in_range">
<code class="descname">particles_in_range</code><span class="sig-paren">(</span><em>compound</em>, <em>dmax</em>, <em>max_particles=20</em>, <em>particle_kdtree=None</em>, <em>particle_array=None</em><span class="sig-paren">)</span><a class="headerlink" href="#mbuild.port.Port.particles_in_range" title="Permalink to this definition">¶</a></dt>
<dd><p>Find particles within a specified range of another particle.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>compound</strong> : mb.Compound</p>
<blockquote>
<div><p>Reference particle to find other particles in range of</p>
</div></blockquote>
<p><strong>dmax</strong> : float</p>
<blockquote>
<div><p>Maximum distance from &#8216;compound&#8217; to look for Particles</p>
</div></blockquote>
<p><strong>max_particles</strong> : int, optional, default=20</p>
<blockquote>
<div><p>Maximum number of Particles to return</p>
</div></blockquote>
<p><strong>particle_kdtree</strong> : mb.PeriodicCKDTree, optional</p>
<blockquote>
<div><p>KD-tree for looking up nearest neighbors. If not provided, a KD-
tree will be generated from all Particles in self</p>
</div></blockquote>
<p><strong>particle_array</strong> : np.ndarray, shape=(n,), dtype=mb.Compound, optional</p>
<blockquote>
<div><p>Array of possible particles to consider for return. If not
provided, this defaults to all Particles in self</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">np.ndarray, shape=(n,), dtype=mb.Compound</p>
<blockquote class="last">
<div><p>Particles in range of compound according to user-defined limits</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><code class="xref py py-obj docutils literal"><span class="pre">periodic_kdtree.PerioidicCKDTree</span></code></dt>
<dd>mBuild implementation of kd-trees</dd>
<dt><code class="xref py py-obj docutils literal"><span class="pre">scipy.spatial.ckdtree</span></code></dt>
<dd>Further details on kd-trees</dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="mbuild.port.Port.referenced_ports">
<code class="descname">referenced_ports</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mbuild.port.Port.referenced_ports" title="Permalink to this definition">¶</a></dt>
<dd><p>Return all Ports referenced by this Compound.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">list of mb.Compound</p>
<blockquote class="last">
<div><p>A list of all ports referenced by the Compound</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="mbuild.port.Port.remove">
<code class="descname">remove</code><span class="sig-paren">(</span><em>objs_to_remove</em><span class="sig-paren">)</span><a class="headerlink" href="#mbuild.port.Port.remove" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove children from the Compound.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>objs_to_remove</strong> : mb.Compound or list of mb.Compound</p>
<blockquote class="last">
<div><p>The Compound(s) to be removed from self</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="mbuild.port.Port.remove_bond">
<code class="descname">remove_bond</code><span class="sig-paren">(</span><em>particle_pair</em><span class="sig-paren">)</span><a class="headerlink" href="#mbuild.port.Port.remove_bond" title="Permalink to this definition">¶</a></dt>
<dd><p>Deletes a bond between a pair of Particles</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>particle_pair</strong> : indexable object, length=2, dtype=mb.Compound</p>
<blockquote class="last">
<div><p>The pair of Particles to remove the bond between</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="mbuild.port.Port.rigid_particles">
<code class="descname">rigid_particles</code><span class="sig-paren">(</span><em>rigid_id=None</em><span class="sig-paren">)</span><a class="headerlink" href="#mbuild.port.Port.rigid_particles" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate all particles in rigid bodies.</p>
<p>If a rigid_id is specified, then this function will only yield particles
with a matching rigid_id.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>rigid_id</strong> : int, optional</p>
<blockquote>
<div><p>Include only particles with this rigid body ID</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Yields:</th><td class="field-body"><p class="first">mb.Compound</p>
<blockquote class="last">
<div><p>The next particle with a rigid_id that is not None, or the next
particle with a matching rigid_id if specified</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="mbuild.port.Port.root">
<code class="descname">root</code><a class="headerlink" href="#mbuild.port.Port.root" title="Permalink to this definition">¶</a></dt>
<dd><p>The Compound at the top of self&#8217;s hierarchy.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">mb.Compound</p>
<blockquote class="last">
<div><p>The Compound at the top of self&#8217;s hierarchy</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="mbuild.port.Port.rotate">
<code class="descname">rotate</code><span class="sig-paren">(</span><em>theta</em>, <em>around</em><span class="sig-paren">)</span><a class="headerlink" href="#mbuild.port.Port.rotate" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotate Compound around an arbitrary vector.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>theta</strong> : float</p>
<blockquote>
<div><p>The angle by which to rotate the Compound, in radians.</p>
</div></blockquote>
<p><strong>around</strong> : np.ndarray, shape=(3,), dtype=float</p>
<blockquote class="last">
<div><p>The vector about which to rotate the Compound.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="mbuild.port.Port.save">
<code class="descname">save</code><span class="sig-paren">(</span><em>filename</em>, <em>show_ports=False</em>, <em>forcefield_name=None</em>, <em>forcefield_files=None</em>, <em>box=None</em>, <em>overwrite=False</em>, <em>residues=None</em>, <em>references_file=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#mbuild.port.Port.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the Compound to a file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filename</strong> : str</p>
<blockquote>
<div><p>Filesystem path in which to save the trajectory. The extension or
prefix will be parsed and control the format. Supported
extensions are: &#8216;hoomdxml&#8217;, &#8216;gsd&#8217;, &#8216;gro&#8217;, &#8216;top&#8217;, &#8216;lammps&#8217;, &#8216;lmp&#8217;</p>
</div></blockquote>
<p><strong>show_ports</strong> : bool, optional, default=False</p>
<blockquote>
<div><p>Save ports contained within the compound.</p>
</div></blockquote>
<p><strong>forcefield_file</strong> : str, optional, default=None</p>
<blockquote>
<div><p>Apply a forcefield to the output file using a forcefield provided
by the <cite>foyer</cite> package.</p>
</div></blockquote>
<p><strong>forcefield_name</strong> : str, optional, default=None</p>
<blockquote>
<div><p>Apply a named forcefield to the output file using the <cite>foyer</cite>
package, e.g. &#8216;oplsaa&#8217;. Forcefields listed here:
<a class="reference external" href="https://github.com/mosdef-hub/foyer/tree/master/foyer/forcefields">https://github.com/mosdef-hub/foyer/tree/master/foyer/forcefields</a></p>
</div></blockquote>
<p><strong>box</strong> : mb.Box, optional, default=self.boundingbox (with buffer)</p>
<blockquote>
<div><p>Box information to be written to the output file. If &#8216;None&#8217;, a
bounding box is used with 0.25nm buffers at each face to avoid
overlapping atoms.</p>
</div></blockquote>
<p><strong>overwrite</strong> : bool, optional, default=False</p>
<blockquote>
<div><p>Overwrite if the filename already exists</p>
</div></blockquote>
<p><strong>residues</strong> : str of list of str</p>
<blockquote>
<div><p>Labels of residues in the Compound. Residues are assigned by
checking against Compound.name.</p>
</div></blockquote>
<p><strong>references_file</strong> : str, optional, default=None</p>
<blockquote>
<div><p>Specify a filename to write references for the forcefield that is
to be applied. References are written in BiBTeX format.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Other Parameters:</th></tr>
<tr class="field-even field"><td>&#160;</td><td class="field-body"><p class="first"><strong>ref_distance</strong> : float, optional, default=1.0</p>
<blockquote>
<div><p>Normalization factor used when saving to .gsd and .hoomdxml formats
for converting distance values to reduced units.</p>
</div></blockquote>
<p><strong>ref_energy</strong> : float, optional, default=1.0</p>
<blockquote>
<div><p>Normalization factor used when saving to .gsd and .hoomdxml formats
for converting energy values to reduced units.</p>
</div></blockquote>
<p><strong>ref_mass</strong> : float, optional, default=1.0</p>
<blockquote class="last">
<div><p>Normalization factor used when saving to .gsd and .hoomdxml formats
for converting mass values to reduced units.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><code class="xref py py-obj docutils literal"><span class="pre">formats.gsdwrite.write_gsd</span></code></dt>
<dd>Write to GSD format</dd>
<dt><code class="xref py py-obj docutils literal"><span class="pre">formats.hoomdxml.write_hoomdxml</span></code></dt>
<dd>Write to Hoomd XML format</dd>
<dt><code class="xref py py-obj docutils literal"><span class="pre">formats.lammpsdata.write_lammpsdata</span></code></dt>
<dd>Write to LAMMPS data format</dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="mbuild.port.Port.spin">
<code class="descname">spin</code><span class="sig-paren">(</span><em>theta</em>, <em>around</em><span class="sig-paren">)</span><a class="headerlink" href="#mbuild.port.Port.spin" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotate Compound in place around an arbitrary vector.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>theta</strong> : float</p>
<blockquote>
<div><p>The angle by which to rotate the Compound, in radians.</p>
</div></blockquote>
<p><strong>around</strong> : np.ndarray, shape=(3,), dtype=float</p>
<blockquote class="last">
<div><p>The axis about which to spin the Compound.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="mbuild.port.Port.successors">
<code class="descname">successors</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mbuild.port.Port.successors" title="Permalink to this definition">¶</a></dt>
<dd><p>Yield Compounds below self in the hierarchy.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Yields:</th><td class="field-body"><p class="first">mb.Compound</p>
<blockquote class="last">
<div><p>The next Particle below self in the hierarchy</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="mbuild.port.Port.to_intermol">
<code class="descname">to_intermol</code><span class="sig-paren">(</span><em>molecule_types=None</em><span class="sig-paren">)</span><a class="headerlink" href="#mbuild.port.Port.to_intermol" title="Permalink to this definition">¶</a></dt>
<dd><p>Create an InterMol system from a Compound.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>molecule_types</strong> : list or tuple of subclasses of Compound</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>intermol_system</strong> : intermol.system.System</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="mbuild.port.Port.to_parmed">
<code class="descname">to_parmed</code><span class="sig-paren">(</span><em>box=None</em>, <em>title=''</em>, <em>residues=None</em><span class="sig-paren">)</span><a class="headerlink" href="#mbuild.port.Port.to_parmed" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a ParmEd Structure from a Compound.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>title</strong> : str, optional, default=self.name</p>
<blockquote>
<div><p>Title/name of the ParmEd Structure</p>
</div></blockquote>
<p><strong>residues</strong> : str of list of str</p>
<blockquote>
<div><p>Labels of residues in the Compound. Residues are assigned by
checking against Compound.name.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">parmed.structure.Structure</p>
<blockquote class="last">
<div><p>ParmEd Structure object converted from self</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><code class="xref py py-obj docutils literal"><span class="pre">parmed.structure.Structure</span></code></dt>
<dd>Details on the ParmEd Structure object</dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="mbuild.port.Port.to_trajectory">
<code class="descname">to_trajectory</code><span class="sig-paren">(</span><em>show_ports=False</em>, <em>chains=None</em>, <em>residues=None</em><span class="sig-paren">)</span><a class="headerlink" href="#mbuild.port.Port.to_trajectory" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert to an md.Trajectory and flatten the compound.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>show_ports</strong> : bool, optional, default=False</p>
<blockquote>
<div><p>Include all port atoms when converting to trajectory.</p>
</div></blockquote>
<p><strong>chains</strong> : mb.Compound or list of mb.Compound</p>
<blockquote>
<div><p>Chain types to add to the topology</p>
</div></blockquote>
<p><strong>residues</strong> : str of list of str</p>
<blockquote>
<div><p>Labels of residues in the Compound. Residues are assigned by
checking against Compound.name.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>trajectory</strong> : md.Trajectory</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><code class="xref py py-obj docutils literal"><span class="pre">_to_topology</span></code></p>
</div>
</dd></dl>

<dl class="method">
<dt id="mbuild.port.Port.translate">
<code class="descname">translate</code><span class="sig-paren">(</span><em>by</em><span class="sig-paren">)</span><a class="headerlink" href="#mbuild.port.Port.translate" title="Permalink to this definition">¶</a></dt>
<dd><p>Translate the Compound by a vector</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>by</strong> : np.ndarray, shape=(3,), dtype=float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="mbuild.port.Port.translate_to">
<code class="descname">translate_to</code><span class="sig-paren">(</span><em>pos</em><span class="sig-paren">)</span><a class="headerlink" href="#mbuild.port.Port.translate_to" title="Permalink to this definition">¶</a></dt>
<dd><p>Translate the Compound to a specific position</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pos</strong> : np.ndarray, shape=3(,), dtype=float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="mbuild.port.Port.unlabel_rigid_bodies">
<code class="descname">unlabel_rigid_bodies</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mbuild.port.Port.unlabel_rigid_bodies" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove all rigid body labels from the Compound</p>
</dd></dl>

<dl class="method">
<dt id="mbuild.port.Port.update_coordinates">
<code class="descname">update_coordinates</code><span class="sig-paren">(</span><em>filename</em>, <em>update_port_locations=True</em><span class="sig-paren">)</span><a class="headerlink" href="#mbuild.port.Port.update_coordinates" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the coordinates of this Compound from a file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filename</strong> : str</p>
<blockquote>
<div><p>Name of file from which to load coordinates. Supported file types
are the same as those supported by load()</p>
</div></blockquote>
<p><strong>update_port_locations</strong> : bool, optional, default=True</p>
<blockquote class="last">
<div><p>Update the locations of Ports so that they are shifted along with
their anchor particles.  Note: This conserves the location of
Ports with respect to the anchor Particle, but does not conserve
the orientation of Ports with respect to the molecule as a whole.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><code class="xref py py-obj docutils literal"><span class="pre">load</span></code></dt>
<dd>Load coordinates from a file</dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="mbuild.port.Port.visualize">
<code class="descname">visualize</code><span class="sig-paren">(</span><em>show_ports=False</em><span class="sig-paren">)</span><a class="headerlink" href="#mbuild.port.Port.visualize" title="Permalink to this definition">¶</a></dt>
<dd><p>Visualize the Compound using nglview.</p>
<p>Allows for visualization of a Compound within a Jupyter Notebook.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>show_ports</strong> : bool, optional, default=False</p>
<blockquote class="last">
<div><p>Visualize Ports in addition to Particles</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="mbuild.port.Port.xyz">
<code class="descname">xyz</code><a class="headerlink" href="#mbuild.port.Port.xyz" title="Permalink to this definition">¶</a></dt>
<dd><p>Return all particle coordinates in this compound.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>pos</strong> : np.ndarray, shape=(n, 3), dtype=float</p>
<blockquote class="last">
<div><p>Array with the positions of all particles.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="mbuild.port.Port.xyz_with_ports">
<code class="descname">xyz_with_ports</code><a class="headerlink" href="#mbuild.port.Port.xyz_with_ports" title="Permalink to this definition">¶</a></dt>
<dd><p>Return all particle coordinates in this compound including ports.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>pos</strong> : np.ndarray, shape=(n, 3), dtype=float</p>
<blockquote class="last">
<div><p>Array with the positions of all particles and ports.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="coordinate_transforms.html" class="btn btn-neutral float-right" title="Coordinate transformations" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="tutorials/tutorial_polymers.html" class="btn btn-neutral" title="Building a Simple Alkane" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2014-2017, Vanderbilt University.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.7.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>